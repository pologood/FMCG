<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <title>收藏商家</title>
    
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<link rel="stylesheet" href="/weixin/style/wap.min.css"/>
<script src="/weixin/js/zepto.min.js"></script>
<script src="/weixin/js/callbacks.js"></script>
<script src="/weixin/js/deferred.js"></script>
<script src="/weixin/js/handlebars.min.js"></script>
<script src="/weixin/js/lazyload.min.js"></script>
<script src="/weixin/js/iSlider.min.js"></script>
<script src="/weixin/js/iSlider.animate.min.js"></script>
<script src="/weixin/js/fly.min.js"></script>
<script src="/weixin/js/requestAnimationFrame.js"></script>
<script src="/weixin/js/iscroll.js"></script>
<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>


  

</head>
<body ontouchstart>
<div class="weui-toptips weui-toptips_warn js_tooltips">错误提示</div>
<script type="text/html" id="tpl_toast">

    <!--BEGIN toast-->
    <div id="toast" style="display: none;">
        <div class="weui-mask_transparent"></div>
        <div class="weui-toast">
            <i class="weui-icon-info-circle weui-icon_toast"></i>
            <p class="weui-toast__content">已完成</p>
        </div>
    </div>
    <!--end toast-->

    <!-- loading toast -->
    <div id="loadingToast" style="display:none;">
        <div class="weui-mask_transparent"></div>
        <div class="weui-toast">
            <i class="weui-loading weui-icon_toast"></i>
            <p class="weui-toast__content">努力加载</p>
        </div>
    </div>

</script>
<script type="text/html" id="tpl_dialog">

    <!--BEGIN dialog1-->
    <div id="dialog1" style="display: none;">
        <div class="weui-mask"></div>
        <div class="weui-dialog">
            <div class="weui-dialog__hd"><strong class="weui-dialog__title">弹窗标题</strong></div>
            <div class="weui-dialog__bd">弹窗内容，告知当前状态、信息和解决方法，描述文字尽量控制在三行内</div>
            <div class="weui-dialog__ft">
                <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_default">否</a>
                <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary">是</a>
            </div>
        </div>
    </div>
    <!--END dialog1-->
    <!--BEGIN dialog2-->
    <div id="dialog2" style="display: none;">
        <div class="weui-mask"></div>
        <div class="weui-dialog">
            <div class="weui-dialog__bd">弹窗内容，告知当前状态、信息和解决方法，描述文字尽量控制在三行内</div>
            <div class="weui-dialog__ft">
                <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary">知道了</a>
            </div>
        </div>
    </div>
    <!--END dialog2-->

</script>
<div class="container" id="container"></div>


<!--收藏-->
<script type="text/html" id="tpl_favorite-tenant">
<div class="page">
    

    <!--BEGIN toast-->
    <div id="toast" style="display: none;">
        <div class="weui-mask_transparent"></div>
        <div class="weui-toast">
            <i class="weui-icon-info-circle weui-icon_toast"></i>
            <p class="weui-toast__content">已完成</p>
        </div>
    </div>
    <!--end toast-->

    <!-- loading toast -->
    <div id="loadingToast" style="display:none;">
        <div class="weui-mask_transparent"></div>
        <div class="weui-toast">
            <!--<i class="weui-loading weui-icon_toast"></i>-->
            <p class="weui-toast__content">努力加载</p>
        </div>
    </div>


    

    <!--BEGIN dialog1-->
    <div id="dialog1" style="display: none;">
        <div class="weui-mask"></div>
        <div class="weui-dialog">
            <div class="weui-dialog__hd"><strong class="weui-dialog__title">操作提示</strong></div>
            <div class="weui-dialog__bd">弹窗内容，告知当前状态、信息和解决方法，描述文字尽量控制在三行内</div>
            <div class="weui-dialog__ft">
                <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_default">否</a>
                <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary">是</a>
            </div>
        </div>
    </div>
    <!--END dialog1-->
    <!--BEGIN dialog2-->
    <div id="dialog2" style="display: none;">
        <div class="weui-mask"></div>
        <div class="weui-dialog">
            <div class="weui-dialog__bd">弹窗内容，告知当前状态、信息和解决方法，描述文字尽量控制在三行内</div>
            <div class="weui-dialog__ft">
                <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary">知道了</a>
            </div>
        </div>
    </div>
    <!--END dialog2-->


    <div class="page__bd tabBer" style="height: 100%;">
        <div class="vux-tab">
            <div class="vux-tab-item vux-center f14 vux-tab-selected"><a href="../member/favorite-product.html">收藏宝贝</a></div>
            <!--<div class="vux-tab-ink-bar vux-tab-ink-bar-transition-forward" id="bor" style=" left: 0; right:66.66%;"></div>-->
        </div>
        <div class="weui-tab " style="clear:both">
            <!--加载收藏商家-->
            <div class="vux-swiper-item active  user_collect weui-tab__panel pageable"  style="padding: 43px 0 0 0;">

                <div class="weui-cells collshop" >
                </div>
            </div>

        </div>
    </div>
</div>
</div>



<script type="text/javascript">
    $(function () {
        document.title='收藏';

        //定位，获取经纬度
        var jsonsData = {
            pageNumber: 1,
            lat: weixin.lat,
            lng: weixin.lng
        };
        var pge;
        weixin.location(function () {
            jsonsData.lat=weixin.lat;
            jsonsData.lng=weixin.lng;
            pge = $(".pageable").pageable({
                        loadUpFn:function(me) {
                            weixin.location(function () {
                                console.log("lat:" + weixin.lat);
                                console.log("lng:" + weixin.lng);
                            });
                            var tu = new favorite(function (data) {
                                var h = render.fill($("#tpl_collectshop"),data);
                                console.log(data);

                                $(".pageable .collshop").html(h);
                                me.resetload();
                            });
                            tu.tenantList(jsonsData);
                        },
                        loadDownFn :function(me) {
                            var td = new favorite(function (data) {
                                me.pageNumber = me.pageNumber +1;
                                var h = render.fill($("#tpl_collectshop"),data);
                                $(".pageable .collshop").append(h);
                                if (data.length<20){
                                    me.lock();
                                    me.noData();
                                }
                                me.resetload();
                            });
                            td.tenantList(jsonsData);
                        }
                    });
        });

        pushHistory();
        var bool=false;
        setTimeout(function(){
            bool=true;
        },100);
        window.addEventListener("popstate", function(e) {
            if(bool)
            {
                $('.pageable-down').remove();
                location.href=location.origin+"/weixin/member/member-home.html";
            }
            pushHistory();

        }, false);
        function pushHistory() {
            var state = {
                title: "title",
                url: "#"
            };
            window.history.pushState(state,"title","#");
        }
    });


</script>
</script>

<script type="text/html" id="tpl_collectshop">
<!--收藏店铺模板-->
{{#each this}}
<a href="../tenant/tenant-home.html?id={{id}}" class="weui-cell" tenant-id={{id}}>

    <div class="weui-cell__hd">
        {{#compare thumbnail '!=' null}}
        <img src="{{thumbnail}}" />
        {{/compare}}
        {{#compare thumbnail '==' null}}
        <img src="../images/placeholder/tenant.png" />
        {{/compare}}
    </div>
    <div class="weui-cell__bd">
        <p class="Ftitle">{{name}}</p>
        <div class="weui-flex">
            <div class="weui-flex__item Ftext">主营：<span>{{tenantCategoryName}}</span></div>
        </div>
        <div class="border-top">
            <div class="weui-cell">
                <div class="weui-cell__bd Fauxiliary" style="margin-left:-1.5vw;">{{address}}</div>
                <div class="weui-cell__ft Fauxiliary">{{#ifcond distance -1}}{{distance}}km{{else}}{{/ifcond}}<i class="icon iconfont icon-s-location"></i></div>
            </div>
        </div>
    </div>
</a>
{{/each}}
</script>



<script src="/weixin/js/wap.min.js"></script>



<script type="text/javascript">
    $(function () {
        pageManager.show("favorite-tenant");
    });
</script>
</body>
</html>

